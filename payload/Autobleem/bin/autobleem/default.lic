Hacked By DoctorDalek / Plain C version by Screemer